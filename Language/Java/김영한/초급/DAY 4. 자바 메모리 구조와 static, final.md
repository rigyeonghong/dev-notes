# 7.  자바 메모리 구조와 static

![[Pasted image 20240418153956.png]]
* 메서드 영역 : 클래스 정보 보관
* 스택 영역 : 실제 프로그램 실행되는 영역. 메서드 시행때마다 하나씩 쌓임.
* 힙 영역 : 인스턴스 생성되는 영역(new). 배열도 이 영역에 생성.

![[Pasted image 20240418154553.png]]
* 메서드 영역
	* 클래스 정보 : 클래스의 실행 코드(바이트 코드), 필드, 메서드와 생성자 코드 등
	* static 영역 : static 변수 보관.
	* 런타임 상수 풀 : 프로그램 실행하는데 필요한 공통 리터럴 상수 보관. ex. "hello"라는 리터럴 문자. 이 외에도 프로그램 효율적 관리위한 상수 관리.
* 스택 영역 : 자바 실행시, 하나의 실행 스택 생성. 각 스택 프레임은 지역 변수, 중간 연산 결과, 메서드 호출 정보 포함. 더 정확히는 **각 쓰레드별로 하나의 실행 스택 생성**.
	* 스택 프레임 : 메서드 호출시마다 하나의 스택프레임 쌓이고, 종료되면 제거.
* 힙 영역 : 인스턴스와 배열 생성되는 영역. GC가 이뤄지는 주요 영역으로 더이상 참조되지 않는 객체는 제거.

* **메서드 코드는 메서드 영역에**
	* 인스턴스의 메서드 호출시 실제로는 메서드 영역에 있는 코드 불러서 수행

#### static 변수
 * static 변수(정적 변수/클래스 변수)
	 * 주로 멤버변수와 메서드에 사용.
	 * static이 붙은 멤버 변수는 메서드 영역에서 관리.
	 * 자신의 클래스에 있는 정적 변수라면 클래스명 생략 가능.

* 멤버 변수의 종류
	* 인스턴스 변수 : static  붙지 않은 멤버 변수
	* 클래스 변수 : static 붙은 멤버 변수. 
		* **자바 프로그램 시작할 때 딱 1개 만들어짐.** 여러 곳에서 **공유 목적**으로 사용. 
		* JVM 종료될 때까지 생명주기가 이어짐. 프로그램 실행 시점에 만들어지고 종료 시점에 제거 : 정적 변수 <-> 동적변수 : 힙 영역에 생성되는 인스턴스 변수.

* 정적 변수가 인스턴스를 통한 접근 가능하나, 권장하지 않음 : 코드를 봤을 때 인스턴스 변수에 접근하는 것처럼 오해하게됨. ➡️ 클래스를 통한 접근이 더 명확.

#### static 메서드
* 클래스 메서드/ 클래스 메서드 : 메서드 앞에 static 붙인 것.
* 인스턴스 메서드 : static 붙지 않아 인스턴스 생성해야 호출 가능.
* 정적 메서드 언제나 사용 가능한 거 아님
	* static 메서드는 정적 메서드나, 정적 변수만 사용 가능.
	* 물론 객체의 참조값을 매개변수로 받으면 인스턴스 변수/메서드 호출 가능.
* 반대로 모든 곳에서 static 호출 가능.

* 멤버 메서드의 종류
	* 인스턴스 메서드 : static 이 붙지 않은 멤버 메서드
	* 클래스 메서드 : static이 붙은 멤버 메서드
	
* 인스턴스 통한 접근 가능하나 비추, 클래스 통한 접근 추천 : 코드 이해하기 쉬움.

#### static import
* import static : 클래스명 생략 가능.

#### main() 메서드는 정적 메서드
* 인스턴스 생성 없이 실행하는 대표 메서드
* 정적 메서드인 main()이 호출하는 메서드에는 정적 메스드를 사용.

# 8.  final

#### final 변수와 상수
* 변수에 `final` 키워드 붙으면 더는 값 변경 불가. 컴파일 오류 발생.
* `final` 은 `class` , `method` 를 포함한 여러 곳에 붙을 수 있다.
* 생성자로 초기화 가능.
* static 변수에도 선언 가능. 
	```java
	static final in CONST_VALUE = 10;
	```
	* 중복과 메모리 비효율 문제 해결 가능.

* 상수 : 변하지 않고, 일정한 값 갖는 수.
	* static final 키워드 사용.
	* 필드 직접  접근해도 데이터 변하는 문제 발생하지 않음.
	* 매직 넘버 문제 해결. 변수명을 코드로 이해 가능.

#### final 변수와 참조
* 참조형 변수에 final 이 붙으면 참조값을 변경 못함.
	* 참조하는 대상의 데이터 값은 변경 가능 (final이 아니라면)

#### 추가나누미💩
* 불변함수 
	* 장점 : 테스트 용이, 재사용성
	* 변경 필요할시 메모리 잡아먹음

* public static 함수 : 모든 애플리케이션 내에서 다같이 사용할 때
	* 인스턴스가 가지고 있는 필드에 접근 불가
	* 인스턴스 상관 없이 class에서 기대하는 함수일 때
		* 길어지면 가독성 떨어져서 빼냄 ➡️ public static 함수로. 그러나 외부에 노출할 기능은 아니기에 private static 함수로.
* private static 함수 목적 : 내부 클래스에서만 사용하는 함수로 사용하기 위해서.